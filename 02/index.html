<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='UTF-8'>
<meta http-equiv='Content-Type' content='text/html;charset=utf-8'>
<meta name='viewport' content='width=device-width'>
<script src='https://d3js.org/d3.v4.js'></script>
<script src='d3-tip.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.10.3/babel.min.js'></script>
<link rel='icon' href='data:;base64,iVBORw0KGgo='>
<script src='d3-exploding-boxplot.js'></script>
</head>
<body id='body'>
<div id='chartContainer'>
</div>
<script lang='babel' type='text/babel'>
  d3.csv('iris.csv', (error, inputData) => {
    if (error) throw error;
    console.log('data', data);

    // tell explodingBoxplot how to group, color, and position
    // the boxplots that represent our randomNormal data
    const options = {
      y: 'petalLength',
      data: {
        group: 'class',
        colorIndex: 'class',
      },
      color: 'class',
      label: '',
      axes: {
        x: {
          variable: 'class',
          label: 'class'
        },
        y: {
          variable: 'petalLength',
          label: 'petalLength'
        }
      },
      numericColumns: [
        'petalLength',
        'petalWidth',
        'sepalLength',
        'sepalWidth'
      ],
      sortBoxplots: true
    };
    console.log('options for explodingBoxplot', options);

    // parse strings to numbers for numeric columns
    const numericColumns = options.numericColumns;
    const data = [];
    inputData.forEach((d, i) => {
      data.push(d);
      numericColumns.forEach(e => {
        data[i][e] = Number(d[e]);
      })
      if (typeof idColumn === 'undefined') {
        data[i].id = i;
      }
    });

    // see what we are working with
    console.log('d3ExplodingBoxplot', d3ExplodingBoxplot);

    // assign a explodingBoxplot chart object to a variable called chart
    const chart = d3ExplodingBoxplot.d3ExplodingBoxplot();
    
    // call the chart's data accessor function on our data
    chart.data(data);

    // call the chart's options accessor function on our options object
    chart.options(options);

    // call the explodingBoxplot `chart` function itself on a selector
    // in this case the id of a div
    const selector = d3.select('#chartContainer') 
    chart(selector);

    // call the update function to render the exploding boxplots
    chart.update();
  });
</script>
</body>
</html>
